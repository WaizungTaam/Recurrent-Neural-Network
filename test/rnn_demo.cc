#include "../include/rnn.h"
#include "../include/tensor/matrix.h"

#include <iostream>


int main() {
  RNN model(7, 10);

  // helloworld
  tensor::Matrix<double> X = {{1, 0, 0, 0, 0, 0, 0}, 
                              {0, 1, 0, 0, 0, 0, 0}, 
                              {0, 0, 1, 0, 0, 0, 0}, 
                              {0, 0, 1, 0, 0, 0, 0},
                              {0, 0, 0, 1, 0, 0, 0},
                              {0, 0, 0, 0, 1, 0, 0},
                              {0, 0, 0, 1, 0, 0, 0},
                              {0, 0, 0, 0, 0, 1, 0},
                              {0, 0, 1, 0, 0, 0, 0}},
                         T = {{0, 1, 0, 0, 0, 0, 0}, 
                              {0, 0, 1, 0, 0, 0, 0}, 
                              {0, 0, 1, 0, 0, 0, 0}, 
                              {0, 0, 0, 1, 0, 0, 0}, 
                              {0, 0, 0, 0, 1, 0, 0}, 
                              {0, 0, 0, 1, 0, 0, 0}, 
                              {0, 0, 0, 0, 0, 1, 0}, 
                              {0, 0, 1, 0, 0, 0, 0}, 
                              {0, 0, 0, 0, 0, 0, 1}};
                              
  model.train(X, T, 200, 1e-3);
  std::cout << model.predict(X) << "\n";
}